---
phase: 01-error-handling
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/App.js
autonomous: true

must_haves:
  truths:
    - "App shows Hebrew error message instead of white screen when component crashes"
    - "User can click 'refresh' button to recover from crash"
  artifacts:
    - path: "package.json"
      provides: "react-error-boundary dependency"
      contains: "react-error-boundary"
    - path: "src/App.js"
      provides: "Error boundary wrapper around app"
      contains: "ErrorBoundary"
  key_links:
    - from: "src/App.js"
      to: "react-error-boundary"
      via: "import and wrap"
      pattern: "import.*ErrorBoundary.*from.*react-error-boundary"
---

<objective>
Add error boundary to prevent white screen crashes

Purpose: When any component throws an error during rendering, users see a friendly Hebrew error message with a recovery button instead of a blank white screen.
Output: App wrapped in ErrorBoundary with Hebrew fallback UI
</objective>

<execution_context>
@/home/yacov/.claude/get-shit-done/workflows/execute-plan.md
@/home/yacov/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-error-handling/01-RESEARCH.md
@src/App.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-error-boundary and wrap App</name>
  <files>package.json, src/App.js</files>
  <action>
1. Install react-error-boundary:
   ```bash
   npm install react-error-boundary
   ```

2. In src/App.js, add import at top:
   ```javascript
   import { ErrorBoundary } from 'react-error-boundary';
   ```

3. Create AppCrashFallback component (inside App.js, before App function):
   ```javascript
   function AppCrashFallback({ error, resetErrorBoundary }) {
     return (
       <div className="min-h-screen flex items-center justify-center bg-gray-100" dir="rtl">
         <div className="bg-white p-8 rounded-xl shadow-lg max-w-md text-center">
           <div className="text-6xl mb-4"></div>
           <h1 className="text-2xl font-bold text-gray-800 mb-2">驻拽爪 转拽 砖</h1>
           <p className="text-gray-600 mb-4">
             爪注专! 砖 砖转砖.  专注 转 祝  住 砖 专 转专.
           </p>
           <details className="text-right mb-4">
             <summary className="cursor-pointer text-sm text-gray-500">驻专 </summary>
             <pre className="mt-2 text-xs bg-gray-50 p-2 rounded overflow-auto text-left">
               {error.message}
             </pre>
           </details>
           <button
             onClick={resetErrorBoundary}
             className="bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-700"
           >
             专注 转 驻拽爪
           </button>
         </div>
       </div>
     );
   }
   ```

4. Wrap AuthProvider in App function with ErrorBoundary:
   ```javascript
   function App() {
     return (
       <ErrorBoundary
         FallbackComponent={AppCrashFallback}
         onReset={() => {
           window.location.href = '/';
         }}
       >
         <AuthProvider>
           <AppContent />
         </AuthProvider>
       </ErrorBoundary>
     );
   }
   ```

Do NOT add error boundaries around individual screens yet - the app-level boundary catches all crashes. Screen-level boundaries can be added later if needed for isolation.
  </action>
  <verify>
1. `npm ls react-error-boundary` shows package installed
2. `grep -q "ErrorBoundary" src/App.js` returns success
3. `npm start` launches app without errors
4. App still functions normally (login, hub screens work)
  </verify>
  <done>
- react-error-boundary installed in package.json
- App.js imports ErrorBoundary from react-error-boundary
- AppCrashFallback component exists with Hebrew text
- App function wraps AuthProvider in ErrorBoundary
- App renders normally without visible changes (boundary is invisible when no error)
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify error boundary catches crashes</name>
  <files>src/App.js</files>
  <action>
1. Temporarily add a crash trigger to verify the boundary works. In AppContent, add a button that throws:
   ```javascript
   // TEMPORARY - remove after testing
   const testCrash = () => {
     throw new Error('Test crash for error boundary');
   };
   ```

2. Add a test button in the JSX (inside the loading check, before the return):
   ```javascript
   if (loading) return (
     <div className="text-center mt-20">
       Loading...
       <button onClick={testCrash} className="ml-4 text-red-500">Test Crash</button>
     </div>
   );
   ```

3. Run `npm start`, click the "Test Crash" button
4. Verify the Hebrew error fallback appears instead of white screen
5. Click "专注 转 驻拽爪" and verify it reloads

6. IMPORTANT: Remove the test crash code after verification:
   - Remove the testCrash function
   - Remove the test button from the loading JSX
   - Return loading JSX to original: `if (loading) return <div className="text-center mt-20">Loading...</div>;`

7. Run `npm start` again to confirm clean state
  </action>
  <verify>
1. During test: clicking crash button shows Hebrew fallback UI (not white screen)
2. During test: clicking refresh button reloads the app
3. After cleanup: `grep -q "testCrash" src/App.js` returns failure (code removed)
4. After cleanup: app runs normally
  </verify>
  <done>
- Error boundary confirmed working (crash shows Hebrew fallback)
- Recovery button confirmed working (reloads app)
- Test code removed, app in clean state
- REQ-001 verified: app does not show white screen on component errors
  </done>
</task>

</tasks>

<verification>
Run these checks to verify the plan succeeded:

```bash
# Check dependency installed
npm ls react-error-boundary

# Check ErrorBoundary is imported and used
grep "ErrorBoundary" src/App.js

# Check Hebrew fallback text exists
grep "驻拽爪 转拽 砖" src/App.js

# Start app and verify it loads
npm start
```

Manual verification:
1. App loads normally
2. If you temporarily add a throw statement in a component, you see the Hebrew error page (not white screen)
</verification>

<success_criteria>
- [x] react-error-boundary is in package.json dependencies
- [x] App.js imports ErrorBoundary from react-error-boundary
- [x] AppCrashFallback component shows Hebrew error message
- [x] App function wraps content in ErrorBoundary
- [x] Component crashes show fallback UI instead of white screen
- [x] Recovery button reloads the application
</success_criteria>

<output>
After completion, create `.planning/phases/01-error-handling/01-01-SUMMARY.md`
</output>
